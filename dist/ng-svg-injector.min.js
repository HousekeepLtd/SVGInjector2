/**
 * SVGInjector v2.0.0 - Fast, caching, dynamic inline SVG DOM injection library
 * https://github.com/iconic/SVGInjector
 *
 * Copyright (c) 2014 Waybury <hello@waybury.com>
 * @license MIT
 */
"use strict";var SVGInjector=function(){function e(t){e.instanceCounter++,this.init(t)}var t,n,r,a,s,i,l="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink",c="sprite",u=c+"--",f=[c],p="icon";e.instanceCounter=0,e.prototype.init=function(e){e=e||{},t={},i={},i.isLocal="file:"===window.location.protocol,i.hasSvgSupport=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),n={count:0,elements:[]},r=[],a={},s={},s.evalScripts=e.evalScripts||"always",s.pngFallback=e.pngFallback||!1,s.onlyInjectVisiblePart=e.onlyInjectVisiblePart||!0,s.keepStylesClass="undefined"==typeof e.keepStylesClass?"":e.keepStylesClass,s.spriteClassName="undefined"==typeof e.spriteClassName?c:e.spriteClassName,s.spriteClassIdName="undefined"==typeof e.spriteClassIdName?u:e.spriteClassIdName,s.removeStylesClass="undefined"==typeof e.removeStylesClass?p:e.removeStylesClass,s.removeAllStyles="undefined"==typeof e.removeAllStyles?!1:e.removeAllStyles,s.fallbackClassName="undefined"==typeof e.fallbackClassName?f:e.fallbackClassName,s.prefixStyleTags="undefined"==typeof e.prefixStyleTags?!0:e.prefixStyleTags,s.spritesheetURL="undefined"==typeof e.spritesheetURL||""===e.spritesheetURL?!1:e.spritesheetURL,s.prefixFragIdClass=s.spriteClassIdName,s.forceFallbacks="undefined"==typeof e.forceFallbacks?!1:e.forceFallbacks,s.forceFallbacks&&(i.hasSvgSupport=!1),k(document.querySelector("html"),"no-svg",i.hasSvgSupport),i.hasSvgSupport&&"undefined"==typeof e.removeStylesClass&&N(s.removeStylesClass)},e.prototype.inject=function(e,t,n){if(void 0!==e.length){var r=0,a=this;V.call(e,function(s){a.injectElement(s,function(a){n&&"function"==typeof n&&n(a),t&&e.length===++r&&t(r)})})}else e?this.injectElement(e,function(r){n&&"function"==typeof n&&n(r),t&&t(1),e=null}):t&&t(0)},e.prototype.injectElement=function(e,t){var r;s.spritesheetURL===!1?r=e.getAttribute("data-src")||e.getAttribute("src"):(r=s.spritesheetURL+"#"+S(e),e.setAttribute("data-src",r));var a,l=r.split("#");if(!/\.svg/i.test(r))return void t("Attempted to inject a file with a non-svg extension: "+r);if(!i.hasSvgSupport){var o=e.getAttribute("data-fallback")||e.getAttribute("data-png");return void(o?(e.setAttribute("src",o),t(null)):s.pngFallback?(a=l.length>1?l[1]+".png":r.split("/").pop().replace(".svg",".png"),T(s.fallbackClassName)?d(e,l[1],s.fallbackClassName):I(s.fallbackClassName)?s.fallbackClassName(e,l[1]):"string"==typeof s.fallbackClassName?G(e,s.fallbackClassName):e.setAttribute("src",s.pngFallback+"/"+a),t(null)):t("This browser does not support SVG and no PNG fallback was defined."))}T(s.fallbackClassName)&&v(e,l[1],s.fallbackClassName),-1===n.elements.indexOf(e)&&(n.elements.push(e),e.setAttribute("src",""),x(t,r,e))},e.prototype.getEnv=function(){return i};var d=function(e,t,n){var r="undefined"==typeof n?f:n.slice(0);V.call(r,function(e,n){r[n]=e.replace("%s",t)}),G(e,r)},v=function(e,t,n){n="undefined"==typeof n?f.slice(0):n.slice(0);var r,a=e.getAttribute("class").split(" ");a&&(V.call(n,function(e){e=e.replace("%s",t),r=a.indexOf(e),r>=0&&(a[r]="")}),e.setAttribute("class",E(a.join(" "))))},m=function(e,t){var n,r,a,s=[{def:"linearGradient",attr:"fill"},{def:"radialGradient",attr:"fill"},{def:"clipPath",attr:"clip-path"},{def:"mask",attr:"mask"},{def:"filter",attr:"filter"}];V.call(s,function(s){n=s.def,r=s.attr;for(var i=e.querySelectorAll(n+"[id]"),l=0,o=i.length;o>l;l++){a=i[l].id+"-"+t;for(var c=e.querySelectorAll("["+r+'*="'+i[l].id+'"]'),u=0,f=c.length;f>u;u++)c[u].setAttribute(r,"url(#"+a+")");i[l].id=a}})},g=function(e,t,n){var r;"undefined"==typeof n&&(n=["id","viewBox"]);for(var a=0;a<e.attributes.length;a++)r=e.attributes.item(a),n.indexOf(r.name)<0&&t.setAttribute(r.name,r.value)},y=function(e){var t=document.createElementNS(l,"svg");return V.call(e.childNodes,function(e){t.appendChild(e.cloneNode(!0))}),g(e,t),t},b=function(e,t,n){var r=n.getAttribute("data-src").split("#");if(r.length>1){var a=r[1],s=new RegExp("\\."+a+" ","g"),i=a+"-"+t;e.textContent=e.textContent.replace(s,"."+i+" "),n.setAttribute("class",n.getAttribute("class")+" "+i)}},h=function(e){var t=e.getAttribute("class");return t?t.split(" "):[]},S=function(e){var t=h(e),n="";return V.call(t,function(e){e.indexOf(s.spriteClassIdName)>=0&&(n=e.replace(s.spriteClassIdName,""))}),n},A=function(e,t,n){var r,a,s,i,l,c,u=!1,f=null;if(void 0===n)return t.cloneNode(!0);if(r=t.getElementById(n)){if(i=r.getAttribute("viewBox"),s=i.split(" "),r instanceof SVGSymbolElement)a=y(r),u=!0;else if(r instanceof SVGViewElement){if(f=null,e.onlyInjectVisiblePart){var p='*[width="'+s[2]+'"][height="'+s[3]+'"]';l={},Math.abs(parseInt(s[0]))>0&&(l.x=s[0],p+='[x="'+s[0]+'"]'),Math.abs(parseInt(s[1]))>0&&(l.y=s[1],p+='[y="'+s[1]+'"]'),f=t.querySelector(p)}if(f&&f instanceof SVGSVGElement){a=f.cloneNode(!0);for(var d in l)"width"!==d&&"height"!==d&&a.removeAttribute(d)}else if(f&&f instanceof SVGUseElement){var v=t.getElementById(f.getAttributeNS(o,"href").substr(1));a=y(v),i=v.getAttribute("viewBox"),s=i.split(" "),u=!0}else u=!0,a=t.cloneNode(!0)}u&&(a.setAttribute("viewBox",s.join(" ")),a.setAttribute("width",s[2]+"px"),a.setAttribute("height",s[3]+"px")),c=h(a);var m=e.prefixFragIdClass+n;return c.indexOf(m)<0&&(c.push(m),a.setAttribute("class",c.join(" "))),a}},C=function(e,t,n,a){r[e]=r[e]||[],r[e].push({callback:n,fragmentId:t,element:a})},w=function(e){for(var t,n=0,a=r[e].length;a>n;n++)!function(n){setTimeout(function(){t=r[e][n],j(e,t.fragmentId,t.callback,t.element)},0)}(n)},x=function(e,n,r){var a,s,l;if(a=n.split("#"),s=a[0],l=2===a.length?a[1]:void 0,void 0!==t[s])t[s]instanceof SVGSVGElement?j(s,l,e,r):C(s,l,e,r);else{if(!window.XMLHttpRequest)return e("Browser does not support XMLHttpRequest"),!1;t[s]={},C(s,l,e,r);var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){if(404===o.status||null===o.responseXML)return e("Unable to load SVG file: "+s),!1;if(!(200===o.status||i.isLocal&&0===o.status))return e("There was a problem injecting the SVG: "+o.status+" "+o.statusText),!1;if(o.responseXML instanceof Document)t[s]=o.responseXML.documentElement;else if(DOMParser&&DOMParser instanceof Function){var r;try{var a=new DOMParser;r=a.parseFromString(o.responseText,"text/xml")}catch(l){r=void 0}if(!r||r.getElementsByTagName("parsererror").length)return e("Unable to parse SVG file: "+n),!1;t[s]=r.documentElement}w(s)}},o.open("GET",s),o.overrideMimeType&&o.overrideMimeType("text/xml"),o.send()}},N=function(e){var t="svg."+e+" {fill: currentColor;}",n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t)),n.appendChild(r)},k=function(e,t,n){n?e.className.replace(t,""):e.className+=" "+t},j=function(e,r,i,l){var o=A(s,t[e],r);if("undefined"==typeof o||"string"==typeof o)return i(o),!1;var c=l.getAttribute("id");c&&o.setAttribute("id",c);var u=l.getAttribute("title");u&&o.setAttribute("title",u);var f=[].concat(o.getAttribute("class")||[],"injected-svg",l.getAttribute("class")||[]).join(" ");o.setAttribute("class",E(f));var p=l.getAttribute("style");p&&o.setAttribute("style",p);var d=[].filter.call(l.attributes,function(e){return/^data-\w[\w\-]*$/.test(e.name)});V.call(d,function(e){e.name&&e.value&&o.setAttribute(e.name,e.value)});var v=l.getAttribute("preserveAspectRatio");v&&o.setAttribute("preserveAspectRatio",v),m(o,n.count),o.removeAttribute("xmlns:a");for(var g,y,S=o.querySelectorAll("script"),C=[],w=0,x=S.length;x>w;w++)y=S[w].getAttribute("type"),y&&"application/ecmascript"!==y&&"application/javascript"!==y||(g=S[w].innerText||S[w].textContent,C.push(g),o.removeChild(S[w]));if(C.length>0&&("always"===s.evalScripts||"once"===s.evalScripts&&!a[e])){for(var N=0,k=C.length;k>N;N++)new Function(C[N])(window);a[e]=!0}var j=o.querySelectorAll("style");V.call(j,function(e){var t=h(o);(t.indexOf(s.removeStylesClass)>=0||s.removeAllStyles)&&t.indexOf(s.keepStylesClass)<0?e.parentNode.removeChild(e):s.prefixStyleTags?b(e,n.count,o):e.textContent+=""}),l.parentNode.replaceChild(o,l),delete n.elements[n.elements.indexOf(l)],n.count++,i(o)},E=function(e){e=e.split(" ");for(var t={},n=e.length,r=[];n--;)t.hasOwnProperty(e[n])||(t[e[n]]=1,r.unshift(e[n]));return r.join(" ")},I=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},T=function(e){return"[object Array]"===Object.prototype.toString.call(e)},G=function(e,t){var n=e.getAttribute("class");n=n?n:"",T(t)&&(t=t.join(" ")),t=n+" "+t,e.setAttribute("class",E(t))},V=Array.prototype.forEach||function(e,t){if(void 0===this||null===this||"function"!=typeof e)throw new TypeError;var n,r=this.length>>>0;for(n=0;r>n;++n)n in this&&e.call(t,this[n],n,this)};return e}();angular.module("svginjector",[]).value("injectorOptions",{}),angular.module("svginjector").directive("svg",["svgInjectorFactory",function(e){return{restrict:"E",replace:!0,scope:{},link:function(t,n){e.inject(n[0])}}}]),angular.module("svginjector").factory("svgInjectorFactory",["injectorOptions",function(e){return new SVGInjector(e)}]);