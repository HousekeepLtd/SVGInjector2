{"version":3,"sources":["./src/svg-injector.js"],"names":["window","document","SVGInjector","options","instanceCounter","this","init","svgCache","injections","requestQueue","ranScripts","config","env","setFallbackClassNames","removeFallbackClassNames","suffixIdReferences","suffixIdReferencesInStyles","copyAttributes","cloneSymbolAsSVG","doPrefixStyleTags","getClassList","getSpriteIdFromClass","cloneSvg","queueRequest","processRequestQueue","loadSvg","writeDefaultClass","replaceNoSVGClass","onLoadSVG","uniqueClasses","isFunction","isArray","svgElemSetClassName","forEach","setRootLevelElem","addRootLevelElem","SVG_NS","XLINK_NS","DEFAULT_SPRITE_CLASS_NAME","DEFAULT_SPRITE_CLASS_ID_NAME","DEFAULT_FALLBACK_CLASS_NAMES","DEFAULT_REMOVESTYLES_CLASS_NAME","prototype","isLocal","location","protocol","hasSvgSupport","implementation","hasFeature","count","elements","evalScripts","pngFallback","onlyInjectVisiblePart","keepStylesClass","spriteClassName","spriteClassIdName","removeStylesClass","removeAllStyles","fallbackClassName","prefixStyleTags","spritesheetURL","prefixFragIdClass","forceFallbacks","querySelector","inject","onDoneCallback","eachCallback","undefined","length","elementsLoaded","ctx","call","element","injectElement","svg","el","onElementInjectedCallback","spriteId","imgUrl","getAttribute","setAttribute","imgUrlSplitByFId","split","push","fallbackUrl","test","perElementFallback","pop","replace","indexOf","getEnv","getConfig","symbolId","classNames","className","slice","curClassName","idx","fallbackClassNames","idxOfCurClass","curClassNames","classAttribute","curFallbackClassName","join","styleTag","suffix","name","numRefs","textContent","match","newName","definitions","defLen","defIdx","refrences","refLen","refIdx","attrs","attrLen","attrIdx","allLinks","allLinksLen","allLinksIdx","links","linkLen","linkIdx","defs","def","elem","querySelectorAll","id","getAttributeNS","toString","setAttributeNS","svgElemSource","svgElemTarget","attributesToIgnore","curAttr","i","attributes","item","value","svgSymbol","createElementNS","childNodes","child","appendChild","cloneNode","injectCount","regex","origPrefixClassName","newPrefixClassName","srcFileNameArr","regexSearchResult","selectorArr","srcArr","styleTagContent","newContent","prefixSelector","arr","RegExp","exec","trim","tmp","svgToCheck","curClassAttr","classes","curClass","sourceSvg","fragId","svgElem","newSVG","viewBox","viewBoxAttr","symbolAttributesToFind","curClassList","symobolList","setViewboxOnNewSVG","symbolElem","getElementById","SVGSymbolElement","SVGViewElement","selector","Math","abs","parseInt","x","y","SVGSVGElement","prop","removeAttribute","SVGUseElement","referencedSymbol","substr","fragIdClassName","fileName","callback","fragmentId","url","requestQueueElem","len","index","setTimeout","urlArr","fileUrl","pathArr","XMLHttpRequest","httpRequest","onreadystatechange","readyState","status","responseXML","statusText","Document","documentElement","DOMParser","Function","xmlDoc","parser","parseFromString","responseText","e","getElementsByTagName","open","overrideMimeType","send","css","head","style","createElement","type","styleSheet","cssText","createTextNode","noSVGClassName","titleId","descId","ariaHidden","children","curChildElem","SVGDefsElement","SVGTitleElement","SVGDescElement","classMerge","concat","script","scriptType","scripts","scriptsToEval","k","scriptsLen","innerText","removeChild","l","scriptsToEvalLen","styleTags","svgClassList","stylesUntouched","parentNode","replaceChild","list","hash","out","hasOwnProperty","unshift","obj","constructor","apply","Object","newClassNames","curClasses","Array","fn","scope","TypeError","addDefault","existingElem","elemId","firstChild","text","insertBefore","newElem","angular","module","provider","injectorOpts","set","opts","$get","factory","svgInjectorOptions","directive","svgInjectorFactory","cfg","restrict","link","$observe","dataSrc","src","exports","define","amd"],"mappings":"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","file":"./dist/svg-injector.min.js","sourcesContent":["/*!\r\n * SVGInjector v${VERSION} - Fast, caching, dynamic inline SVG DOM injection library\r\n * https://github.com/flobacher/SVGInjector2\r\n * forked from:\r\n * https://github.com/iconic/SVGInjector\r\n *\r\n * Copyright (c) 2015 flobacher <flo@digital-fuse.net>\r\n * @license MIT\r\n *\r\n * original Copyright (c) 2014 Waybury <hello@waybury.com>\r\n * @license MIT\r\n */\r\n(function(window, document) {\r\n  'use strict';\r\n  /**\r\n   * SVGInjector\r\n   *\r\n   * Replace the given elements with their full inline SVG DOM elements.\r\n   *\r\n   * :NOTE: We are using get/setAttribute with SVG because the SVG DOM spec differs from HTML DOM and\r\n   * can return other unexpected object types when trying to directly access svg properties.\r\n   * ex: \"className\" returns a SVGAnimatedString with the class value found in the \"baseVal\" property,\r\n   * instead of simple string like with HTML Elements.\r\n   */\r\n  var SVGInjector = (function () {\r\n\r\n\r\n    /**\r\n     * Constructor Function\r\n     * @param {object} options\r\n     */\r\n    function SVGInjector (options) {\r\n      SVGInjector.instanceCounter++;\r\n      this.init(options);\r\n    }\r\n\r\n    // - private constants -----------------------------------------\r\n    var SVG_NS = 'http://www.w3.org/2000/svg';\r\n    var XLINK_NS = 'http://www.w3.org/1999/xlink';\r\n    var DEFAULT_SPRITE_CLASS_NAME = 'sprite';\r\n    var DEFAULT_SPRITE_CLASS_ID_NAME = DEFAULT_SPRITE_CLASS_NAME + '--';\r\n    var DEFAULT_FALLBACK_CLASS_NAMES = [DEFAULT_SPRITE_CLASS_NAME];\r\n    var DEFAULT_REMOVESTYLES_CLASS_NAME = 'icon';\r\n\r\n    // - private member vars ---------------------------------------\r\n    var svgCache;\r\n    var injections;\r\n    var requestQueue;\r\n    var ranScripts;\r\n    var config;\r\n    var env;\r\n\r\n    // - private member funcs --------------------------------------\r\n    var\r\n      setFallbackClassNames,\r\n      removeFallbackClassNames,\r\n      suffixIdReferences,\r\n      suffixIdReferencesInStyles,\r\n      copyAttributes,\r\n      cloneSymbolAsSVG,\r\n      doPrefixStyleTags,\r\n      getClassList,\r\n      getSpriteIdFromClass,\r\n      cloneSvg,\r\n      queueRequest,\r\n      processRequestQueue,\r\n      loadSvg,\r\n      writeDefaultClass,\r\n      replaceNoSVGClass,\r\n      onLoadSVG,\r\n      uniqueClasses,\r\n      isFunction,\r\n      isArray,\r\n      svgElemSetClassName,\r\n      forEach,\r\n      setRootLevelElem,\r\n      addRootLevelElem\r\n    ;\r\n\r\n\r\n\r\n    requestQueue = [];\r\n\r\n    // - static vars -----------------------------------------------\r\n    SVGInjector.instanceCounter = 0;\r\n\r\n    // - public member vars ----------------------------------------\r\n    //SVGInjector.prototype.varName = {};\r\n\r\n\r\n\r\n    // - public member functions ---------------------------------------\r\n    /**\r\n     * @param {object} options\r\n     */\r\n    SVGInjector.prototype.init = function(options) {\r\n      options = options || {};\r\n      svgCache = {};\r\n      env = {};\r\n      env.isLocal = window.location.protocol === 'file:';\r\n      env.hasSvgSupport = document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1');\r\n\r\n      injections = {\r\n        count: 0,\r\n        elements: []\r\n      };\r\n\r\n      ranScripts = {};\r\n      config = {};\r\n\r\n      // Should we run the scripts blocks found in the SVG\r\n      // 'always' - Run them every time\r\n      // 'once' - Only run scripts once for each SVG\r\n      // [false|'never'] - Ignore scripts\r\n      config.evalScripts = options.evalScripts || 'always';\r\n\r\n      // Location of fallback pngs, if desired\r\n      config.pngFallback = options.pngFallback || false;\r\n\r\n      // Only inject the part of the svg, that is specified\r\n      // as visible through the id of an SVGViewElement\r\n      // is default mode\r\n      config.onlyInjectVisiblePart = options.onlyInjectVisiblePart || true;\r\n\r\n      config.keepStylesClass  = (typeof options.keepStylesClass === 'undefined') ?\r\n        '' : options.keepStylesClass;\r\n\r\n      config.spriteClassName  = (typeof options.spriteClassName === 'undefined') ?\r\n        DEFAULT_SPRITE_CLASS_NAME : options.spriteClassName;\r\n\r\n      config.spriteClassIdName  = (typeof options.spriteClassIdName === 'undefined') ?\r\n        DEFAULT_SPRITE_CLASS_ID_NAME : options.spriteClassIdName;\r\n\r\n      config.removeStylesClass = (typeof options.removeStylesClass === 'undefined') ?\r\n        DEFAULT_REMOVESTYLES_CLASS_NAME : options.removeStylesClass;\r\n\r\n      config.removeAllStyles = (typeof options.removeAllStyles === 'undefined') ?\r\n        false : options.removeAllStyles;\r\n\r\n      config.fallbackClassName = (typeof options.fallbackClassName === 'undefined') ?\r\n        DEFAULT_FALLBACK_CLASS_NAMES : options.fallbackClassName;\r\n\r\n      config.prefixStyleTags  = (typeof options.prefixStyleTags === 'undefined') ?\r\n        true : options.prefixStyleTags;\r\n\r\n      config.spritesheetURL = (typeof options.spritesheetURL === 'undefined' || options.spritesheetURL === '') ?\r\n        false : options.spritesheetURL;\r\n\r\n      config.prefixFragIdClass = config.spriteClassIdName;\r\n\r\n      config.forceFallbacks = (typeof options.forceFallbacks === 'undefined') ?\r\n        false : options.forceFallbacks;\r\n\r\n      if(config.forceFallbacks){\r\n        env.hasSvgSupport = false;\r\n      }\r\n\r\n      replaceNoSVGClass(document.querySelector('html'), 'no-svg', env.hasSvgSupport);\r\n\r\n      if(env.hasSvgSupport && typeof options.removeStylesClass === 'undefined' ){ // user does not want to use his own custom class -> write this style tag\r\n        writeDefaultClass(config.removeStylesClass);\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Inject 1+ elements\r\n     * @param {elements} Array of or single DOM element\r\n     * @param {function} onDoneCallback\r\n     * @param {function} eachCallback\r\n     */\r\n    SVGInjector.prototype.inject = function(elements, onDoneCallback, eachCallback) {\r\n      if (elements.length !== undefined) {\r\n        var elementsLoaded = 0;\r\n        var ctx = this;\r\n        forEach.call(elements, function (element) {\r\n          ctx.injectElement(element, function (svg) {\r\n            if (eachCallback && typeof eachCallback === 'function') eachCallback(svg);\r\n            if (onDoneCallback && elements.length === ++elementsLoaded) onDoneCallback(elementsLoaded);\r\n          });\r\n        });\r\n      }\r\n      else {\r\n        if (elements) {\r\n          this.injectElement(elements, function (svg) {\r\n            if (eachCallback && typeof eachCallback === 'function') eachCallback(svg);\r\n            if (onDoneCallback) onDoneCallback(1);\r\n            elements = null;\r\n          });\r\n        }\r\n        else {\r\n          if (onDoneCallback) onDoneCallback(0);\r\n        }\r\n      }\r\n    };\r\n\r\n\r\n    /**\r\n     * Inject a single element\r\n     * @param {elements} Array of or single DOM element\r\n     * @param {function} onDoneCallback\r\n     * @param {function} eachCallback\r\n     */\r\n    SVGInjector.prototype.injectElement = function (el, onElementInjectedCallback) {\r\n      var imgUrl = el.getAttribute('data-src') || el.getAttribute('src'),\r\n          spriteId;\r\n\r\n      if (!imgUrl) {\r\n        if (config.spritesheetURL) {\r\n          spriteId = getSpriteIdFromClass(el);\r\n          if (spriteId === '') {\r\n            // console.warn('neither data-src nor spriteId class found! Nothing to inject here!');\r\n            return;\r\n          }\r\n          imgUrl = config.spritesheetURL + '#' + spriteId;\r\n          // console.log('imgURL: ' + imgUrl);\r\n        } else {\r\n          // console.warn('neither data-src nor spritesheetURL specified! Nothing to inject here!');\r\n          return;\r\n        }\r\n      }\r\n\r\n      el.setAttribute('data-src', imgUrl);\r\n\r\n      var imgUrlSplitByFId = imgUrl.split('#');\r\n      if (imgUrlSplitByFId.length === 1) {\r\n        imgUrlSplitByFId.push('');\r\n      }\r\n\r\n      var fallbackUrl;\r\n\r\n      // We can only inject SVG\r\n      if (!(/\\.svg/i).test(imgUrl)) {\r\n        onElementInjectedCallback('Attempted to inject a file with a non-svg extension: ' + imgUrl);\r\n        return;\r\n      }\r\n\r\n\r\n      if (env.hasSvgSupport) {\r\n        if (isArray(config.fallbackClassName)) {\r\n          removeFallbackClassNames(el, imgUrlSplitByFId[1], config.fallbackClassName);\r\n        }\r\n      }\r\n      else {\r\n        // If we don't have SVG support try to fall back to a png,\r\n        // either defined per-element via data-fallback or data-png,\r\n        // or globally via the pngFallback directory setting\r\n\r\n        var perElementFallback = el.getAttribute('data-fallback') || el.getAttribute('data-png');\r\n\r\n        // Per-element specific PNG fallback defined, so use that\r\n        if (perElementFallback) {\r\n          el.setAttribute('src', perElementFallback);\r\n          onElementInjectedCallback(null);\r\n        }\r\n        // Global PNG fallback directory defined, use the same-named PNG\r\n        else if (config.pngFallback) {\r\n\r\n          if (imgUrlSplitByFId.length > 1 && imgUrlSplitByFId[1]) {\r\n            fallbackUrl = imgUrlSplitByFId[1] + '.png';\r\n            if (isArray(config.fallbackClassName)) {\r\n              setFallbackClassNames(el, imgUrlSplitByFId[1], config.fallbackClassName);\r\n            }\r\n            else if (isFunction(config.fallbackClassName)) {\r\n              // console.info('custom function to create fallbackClassName');\r\n              config.fallbackClassName(el, imgUrlSplitByFId[1]);\r\n            }\r\n            else if (typeof config.fallbackClassName === 'string') {\r\n              svgElemSetClassName(el, config.fallbackClassName);\r\n            }\r\n            else {\r\n              el.setAttribute('src', config.pngFallback + '/' + fallbackUrl);\r\n            }\r\n          }\r\n          else {\r\n            fallbackUrl = imgUrl.split('/').pop().replace('.svg', '.png');\r\n            el.setAttribute('src', config.pngFallback + '/' + fallbackUrl);\r\n          }\r\n\r\n          onElementInjectedCallback(null);\r\n        }\r\n        // um...\r\n        else {\r\n          onElementInjectedCallback('This browser does not support SVG and no PNG fallback was defined.');\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      // Make sure we aren't already in the process of injecting this element to\r\n      // avoid a race condition if multiple injections for the same element are run.\r\n      // :NOTE: Using indexOf() only _after_ we check for SVG support and bail,\r\n      // so no need for IE8 indexOf() polyfill\r\n      if (injections.elements.indexOf(el) !== -1) {\r\n        console.warn('race', el);\r\n        return;\r\n      }\r\n\r\n      // Remember the request to inject this element, in case other injection\r\n      // calls are also trying to replace this element before we finish\r\n      injections.elements.push(el);\r\n\r\n      // Try to avoid loading the orginal image src if possible.\r\n      // el.setAttribute('src', '');\r\n\r\n      // Load it up\r\n      loadSvg(onElementInjectedCallback, imgUrl, el);\r\n\r\n    };\r\n\r\n    SVGInjector.prototype.getEnv = function() {\r\n      return env;\r\n    };\r\n\r\n    SVGInjector.prototype.getConfig = function() {\r\n      return config;\r\n    };\r\n\r\n    // - private member functions -----------------------------------------------\r\n    setFallbackClassNames = function (element, symbolId, classNames) {\r\n      var className =  (typeof classNames === 'undefined') ? DEFAULT_FALLBACK_CLASS_NAMES : classNames.slice(0);\r\n\r\n      // replace %s by symbolId\r\n      forEach.call(\r\n        className,\r\n        function(curClassName, idx) {\r\n          className[idx] = curClassName.replace('%s', symbolId);\r\n        }\r\n      );\r\n\r\n      svgElemSetClassName(element, className);\r\n    };\r\n\r\n    removeFallbackClassNames = function (element, symbolId, fallbackClassNames) {\r\n      fallbackClassNames =  (typeof fallbackClassNames === 'undefined') ? DEFAULT_FALLBACK_CLASS_NAMES.slice(0) : fallbackClassNames.slice(0);\r\n\r\n      var idxOfCurClass,\r\n          curClassNames,\r\n          classAttribute = element.getAttribute('class');\r\n\r\n      if (typeof classAttribute === 'undefined' || classAttribute === null) {\r\n        return;\r\n      }\r\n\r\n      curClassNames = classAttribute.split(' ');\r\n      if (curClassNames) {\r\n        // replace %s by symbolId\r\n        forEach.call(\r\n          fallbackClassNames,\r\n          function(curFallbackClassName) {\r\n            curFallbackClassName = curFallbackClassName.replace('%s', symbolId);\r\n            idxOfCurClass = curClassNames.indexOf(curFallbackClassName);\r\n            if( idxOfCurClass >= 0 ){\r\n              // console.log('remove class ' + curClassName);\r\n              curClassNames[idxOfCurClass] = '';\r\n            }\r\n\r\n          }\r\n        );\r\n\r\n        element.setAttribute('class', uniqueClasses(curClassNames.join(' ')));\r\n      }\r\n\r\n    };\r\n\r\n    suffixIdReferencesInStyles = function (styleTag, suffix, svg, name) {\r\n      //var referencedIds = styleTag.textContent.match(/url\\(('|\")*#.+('|\")*\\)/g) || [];\r\n      /*referencedIds.forEach(function (elem, idx, arr) {\r\n        //elem =  elem.replace(/url\\(('|\")*#/g, '');\r\n        arr[idx] = elem.replace(/\\)/g, '-' + suffix + ')');\r\n        console.log('style', arr[idx]);\r\n      });\r\n      */\r\n      var numRefs = 0;\r\n      styleTag.textContent = styleTag.textContent.replace(/url\\(('|\")*#.+('|\")*(?=\\))/g, function (match) {\r\n        //console.log('match', match + '-' + suffix);\r\n        numRefs++;\r\n        return match + '-' + suffix;\r\n      });\r\n      return numRefs;\r\n    };\r\n\r\n    suffixIdReferences = function (svg, suffix) {\r\n      var defs = [\r\n        {def:'linearGradient',  attrs: ['fill', 'stroke']},\r\n        {def:'radialGradient',  attrs: ['fill', 'stroke']},\r\n        {def:'clipPath',        attrs: ['clip-path']},\r\n        {def:'mask',            attrs: ['mask']},\r\n        {def:'filter',          attrs: ['filter']},\r\n        {def:'color-profile',   attrs: ['color-profile']},\r\n        {def:'cursor',          attrs: ['cursor']},\r\n        {def:'marker',          attrs: ['marker', 'marker-start', 'marker-mid', 'marker-end']}\r\n      ];\r\n\r\n      var newName,\r\n          definitions,\r\n          defLen,\r\n          defIdx,\r\n          refrences,\r\n          refLen,\r\n          refIdx,\r\n          attrs,\r\n          attrLen,\r\n          attrIdx,\r\n          allLinks,\r\n          allLinksLen,\r\n          allLinksIdx,\r\n          links,\r\n          linkLen,\r\n          linkIdx\r\n        ;\r\n\r\n      forEach.call(defs, function(elem) {\r\n\r\n        definitions = svg.querySelectorAll(elem.def + '[id]');\r\n        for (defIdx = 0, defLen = definitions.length; defIdx < defLen; defIdx++) {\r\n          newName = definitions[defIdx].id + '-' + suffix;\r\n\r\n          attrs = elem.attrs;\r\n          for (attrIdx = 0, attrLen = attrs.length; attrIdx < attrLen; attrIdx++) {\r\n\r\n            // console.log('suffixxed ' + attribute + ': ' + newName);\r\n            // :NOTE: using a substring match attr selector here to deal with IE \"adding extra quotes in url() attrs\"\r\n            refrences = svg.querySelectorAll('[' + attrs[attrIdx] + '=\"url(#' + definitions[defIdx].id + ')\"]');\r\n            for (refIdx = 0, refLen = refrences.length; refIdx < refLen; refIdx++) {\r\n              // console.log('set url', newName);\r\n              refrences[refIdx].setAttribute(attrs[attrIdx], 'url(#' + newName + ')');\r\n            }\r\n          }\r\n\r\n          // handle xlink:refrences\r\n          // :NOTE: IE does not like the easy way:  links = svg.querySelectorAll('[*|href=\"#' + definitions[defIdx].id + '\"]');\r\n          allLinks = svg.querySelectorAll('[*|href]');\r\n          links = [];\r\n          for (allLinksIdx = 0, allLinksLen = allLinks.length; allLinksIdx < allLinksLen; allLinksIdx++) {\r\n            if (allLinks[allLinksIdx].getAttributeNS(XLINK_NS, 'href').toString() === '#' + definitions[defIdx].id ) {\r\n              links.push(allLinks[allLinksIdx]);\r\n            }\r\n          }\r\n\r\n          for (linkIdx = 0, linkLen = links.length; linkIdx < linkLen; linkIdx++) {\r\n            links[linkIdx].setAttributeNS(XLINK_NS, 'href', '#' + newName);\r\n            // console.log('set link', newName, links[linkIdx]);\r\n          }\r\n          definitions[defIdx].id = newName;\r\n        }\r\n      });\r\n    };\r\n\r\n    copyAttributes = function (svgElemSource, svgElemTarget, attributesToIgnore) {\r\n      var curAttr;\r\n      if (typeof attributesToIgnore === 'undefined') { attributesToIgnore = ['id', 'viewBox']; }\r\n\r\n      for(var i=0; i<svgElemSource.attributes.length; i++) {\r\n        curAttr = svgElemSource.attributes.item(i);\r\n        if (attributesToIgnore.indexOf(curAttr.name) < 0) {\r\n          svgElemTarget.setAttribute(curAttr.name, curAttr.value);\r\n        }\r\n      }\r\n    };\r\n\r\n    cloneSymbolAsSVG = function (svgSymbol) {\r\n      var svg = document.createElementNS(SVG_NS, 'svg');\r\n      forEach.call(svgSymbol.childNodes, function(child){\r\n\r\n        svg.appendChild(child.cloneNode(true));\r\n\r\n      });\r\n      copyAttributes(svgSymbol, svg);\r\n      return svg;\r\n    };\r\n\r\n\r\n\r\n    doPrefixStyleTags = function (styleTag, injectCount, svg){\r\n      var srcArr = svg.getAttribute('data-src').split('#');\r\n      var regex,\r\n          origPrefixClassName,\r\n          newPrefixClassName,\r\n          srcFileNameArr,\r\n          regexSearchResult,\r\n          styleTagContent = styleTag.textContent,\r\n          newContent = '',\r\n          selectorArr,\r\n          prefixSelector = function(elem, idx, arr){\r\n            arr[idx] = '.' + newPrefixClassName + ' ' + elem;\r\n          },\r\n          stylerule = '';\r\n\r\n      if(srcArr.length > 1) {\r\n        origPrefixClassName = srcArr[1];\r\n        newPrefixClassName = origPrefixClassName + '-' + injectCount;\r\n        regex = new RegExp('\\\\.' + origPrefixClassName + ' ', 'g');\r\n        styleTag.textContent = styleTagContent.replace(regex, '.' + newPrefixClassName + ' ');\r\n      }\r\n      else { //inject a single element.. this has most probaly not gone through preprocessing\r\n        srcFileNameArr = srcArr[0].split('/');\r\n        newPrefixClassName = srcFileNameArr[srcFileNameArr.length-1].replace('.svg', '') + '-' + injectCount;\r\n        // console.info('inject complete file: ' + srcArr[0]);\r\n        //https://medium.com/jotform-form-builder/writing-a-css-parser-in-javascript-3ecaa1719a43\r\n        regex = new RegExp('([\\\\s\\\\S]*?){([\\\\s\\\\S]*?)}', 'g');\r\n\r\n        while ((regexSearchResult = regex.exec(styleTagContent)) !== null) {\r\n          selectorArr = regexSearchResult[1].trim().split(', ');\r\n          selectorArr.forEach(prefixSelector);\r\n\r\n          var tmp =  selectorArr.join(', ') + '{' + regexSearchResult[2] + '}\\n';\r\n          newContent += tmp;\r\n        }\r\n        styleTag.textContent = newContent;\r\n      }\r\n\r\n      svg.setAttribute('class', (svg.getAttribute('class') + ' ' + newPrefixClassName));\r\n    };\r\n\r\n    getClassList = function (svgToCheck) {\r\n      var curClassAttr = svgToCheck.getAttribute('class');\r\n      return (curClassAttr) ? curClassAttr.trim().split(' ') : [];\r\n    };\r\n\r\n    getSpriteIdFromClass = function (element) {\r\n      var classes = getClassList(element);\r\n      var id = '';\r\n      forEach.call(classes, function (curClass) {\r\n        if(curClass.indexOf(config.spriteClassIdName) >= 0) {\r\n          id = curClass.replace(config.spriteClassIdName, '');\r\n          // console.log('class with prefix ' + config.spriteClassIdName + ' found. id: ' + id);\r\n        }\r\n      });\r\n      return id;\r\n    };\r\n\r\n    cloneSvg = function (config, sourceSvg, fragId) {\r\n\r\n      var svgElem,\r\n        newSVG,\r\n        viewBox,\r\n        viewBoxAttr,\r\n        symbolAttributesToFind,\r\n        curClassList,\r\n        setViewboxOnNewSVG = false,\r\n        symbolElem = null,\r\n        symobolList;\r\n\r\n      if(fragId === undefined){\r\n        return sourceSvg.cloneNode(true);\r\n      }\r\n      else {\r\n        svgElem = sourceSvg.getElementById(fragId);\r\n        if(!svgElem){\r\n          console.warn(fragId + ' not found in svg', sourceSvg);\r\n          return;\r\n        }\r\n\r\n        viewBoxAttr = svgElem.getAttribute('viewBox');\r\n        viewBox = viewBoxAttr.split(' ');\r\n\r\n        if (svgElem instanceof SVGSymbolElement) {\r\n\r\n          newSVG = cloneSymbolAsSVG(svgElem);\r\n          setViewboxOnNewSVG = true;\r\n\r\n        }\r\n        else if (svgElem instanceof SVGViewElement) {\r\n          symbolElem = null;\r\n          if (config.onlyInjectVisiblePart) {\r\n            var selector = '*[width=\"' + viewBox[2] + '\"][height=\"' + viewBox[3] + '\"]';\r\n\r\n            symbolAttributesToFind = {};\r\n            if (Math.abs(parseInt(viewBox[0])) === 0) {\r\n              selector += ':not([x])';\r\n            }\r\n            else {\r\n              symbolAttributesToFind.x = viewBox[0];\r\n              selector += '[x=\"' + viewBox[0] + '\"]';\r\n            }\r\n\r\n            if (Math.abs(parseInt(viewBox[1])) === 0) {\r\n              selector += ':not([y])';\r\n            }\r\n            else {\r\n              symbolAttributesToFind.y = viewBox[1];\r\n              selector += '[y=\"' + viewBox[1] + '\"]';\r\n            }\r\n            symobolList = sourceSvg.querySelectorAll(selector);\r\n            if (symobolList.length > 1) {\r\n              console.warn('more than one item, with the matching viewbox found!', symobolList);\r\n            }\r\n            symbolElem = symobolList[0];\r\n          }\r\n          if (symbolElem && (symbolElem instanceof SVGSVGElement)) {\r\n            newSVG = symbolElem.cloneNode(true);\r\n\r\n            for (var prop in symbolAttributesToFind) {\r\n              if (prop !== 'width' && prop !== 'height') {\r\n                newSVG.removeAttribute(prop);\r\n              }\r\n            }\r\n          }\r\n          else if(symbolElem && (symbolElem instanceof SVGUseElement)) {\r\n            // console.log('referenced view shows a SVGUseElement');\r\n            var referencedSymbol = sourceSvg.getElementById(\r\n              symbolElem.getAttributeNS(XLINK_NS, 'href').substr(1)\r\n            );\r\n            newSVG = cloneSymbolAsSVG(referencedSymbol);\r\n            viewBoxAttr = referencedSymbol.getAttribute('viewBox');\r\n            viewBox = viewBoxAttr.split(' ');\r\n            setViewboxOnNewSVG = true;\r\n          }\r\n          else {\r\n            console.info(\r\n              ((config.onlyInjectVisiblePart) ? 'symbol referenced via view' + fragId + ' not found' : 'option.onlyInjectVisiblePart: false') + ' -> clone complete svg!'\r\n            );\r\n            setViewboxOnNewSVG = true;\r\n            newSVG = sourceSvg.cloneNode(true);\r\n\r\n          }\r\n        }\r\n\r\n        if (setViewboxOnNewSVG) {\r\n          newSVG.setAttribute('viewBox', viewBox.join(' '));\r\n          newSVG.setAttribute('width', viewBox[2]+'px');\r\n          newSVG.setAttribute('height', viewBox[3]+'px');\r\n        }\r\n        newSVG.setAttribute('xmlns', SVG_NS);\r\n        newSVG.setAttribute('xmlns:xlink', XLINK_NS);\r\n        //curClassAttr = newSVG.getAttribute('class');\r\n        curClassList = getClassList(newSVG);\r\n        var fragIdClassName = config.prefixFragIdClass + fragId;\r\n        if (curClassList.indexOf(fragIdClassName)<0) {\r\n          curClassList.push(fragIdClassName);\r\n          newSVG.setAttribute('class', curClassList.join(' '));\r\n        }\r\n        return newSVG;\r\n      }\r\n\r\n    };\r\n\r\n    //queueRequest(requestQueue, fileName, fragId, onElementInjectedCallback, el);\r\n    queueRequest = function (fileName, fragId, callback, el) {\r\n      requestQueue[fileName] = requestQueue[fileName] || [];\r\n      requestQueue[fileName].push({callback:callback, fragmentId:fragId, element:el, name: name});\r\n    };\r\n\r\n    processRequestQueue = function (url) {\r\n      var requestQueueElem;\r\n      for (var i = 0, len = requestQueue[url].length; i < len; i++) {\r\n        // Make these calls async so we avoid blocking the page/renderer\r\n        /* jshint loopfunc: true */\r\n        (function (index) {\r\n          setTimeout(function () {\r\n            requestQueueElem = requestQueue[url][index];\r\n            onLoadSVG(url, requestQueueElem.fragmentId, requestQueueElem.callback, requestQueueElem.element, requestQueueElem.name);\r\n          }, 0);\r\n        })(i);\r\n        /* jshint loopfunc: false */\r\n      }\r\n    };\r\n\r\n    loadSvg = function (onElementInjectedCallback, url, el) {\r\n      var urlArr, fileUrl, fragId, name, pathArr;\r\n      //var state = {onElementInjectedCallback:onElementInjectedCallback, injections:injections, config:config, url:url, el:el, ranScripts:ranScripts};\r\n      // console.log('loadSvg', url);\r\n      urlArr = url.split('#');\r\n      fileUrl = urlArr[0];\r\n      fragId = (urlArr.length === 2) ? urlArr[1] : undefined;\r\n      //name = fragId ? undefined : ;\r\n      if (typeof fragId !== 'undefined') {\r\n        pathArr = fileUrl.split('/');\r\n        name = pathArr[pathArr.length-1].replace('.svg', '');\r\n      }\r\n\r\n      if (svgCache[fileUrl] !== undefined) {\r\n        if (svgCache[fileUrl] instanceof SVGSVGElement) {\r\n          // We already have it in cache, so use it\r\n          // console.log('We already have it in cache, so use it', fileName, fragId);\r\n          onLoadSVG(fileUrl, fragId, onElementInjectedCallback, el, name);\r\n        }\r\n        else {\r\n          // console.log('We don\\'t have it in cache yet, but we are loading it, so queue this request', fileName, fragId);\r\n          // We don't have it in cache yet, but we are loading it, so queue this request\r\n          queueRequest(fileUrl, fragId, onElementInjectedCallback, el, name);\r\n        }\r\n      }\r\n      else {\r\n\r\n        if (!window.XMLHttpRequest) {\r\n          onElementInjectedCallback('Browser does not support XMLHttpRequest');\r\n          return false;\r\n        }\r\n\r\n        // Seed the cache to indicate we are loading this URL already\r\n        svgCache[fileUrl] = {};\r\n        queueRequest(fileUrl, fragId, onElementInjectedCallback, el, name);\r\n\r\n        var httpRequest = new XMLHttpRequest();\r\n\r\n        httpRequest.onreadystatechange = function () {\r\n          // readyState 4 = complete\r\n          if (httpRequest.readyState === 4) {\r\n\r\n            // Handle status\r\n            if (httpRequest.status === 404 || httpRequest.responseXML === null) {\r\n              onElementInjectedCallback('Unable to load SVG file: ' + fileUrl);\r\n\r\n              // @check this!\r\n              //if (env.isLocal) {\r\n              //  onLoadCompleteCb('Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver.');\r\n              //}\r\n              //\r\n              //onLoadCompleteCb();\r\n              return false;\r\n            }\r\n\r\n            // 200 success from server, or 0 when using file:// protocol locally\r\n            if (httpRequest.status === 200 || (env.isLocal && httpRequest.status === 0)) {\r\n\r\n              if (httpRequest.responseXML instanceof Document) {\r\n                // Cache it\r\n                svgCache[fileUrl] = httpRequest.responseXML.documentElement;\r\n              }\r\n\r\n              // IE9 doesn't create a responseXML Document object from loaded SVG,\r\n              // and throws a \"DOM Exception: HIERARCHY_REQUEST_ERR (3)\" error when injected.\r\n              //\r\n              // So, we'll just create our own manually via the DOMParser using\r\n              // the the raw XML responseText.\r\n              //\r\n              // :NOTE: IE8 and older doesn't have DOMParser, but they can't do SVG either, so...\r\n              else if (DOMParser && (DOMParser instanceof Function)) {\r\n                var xmlDoc;\r\n                try {\r\n                  var parser = new DOMParser();\r\n                  xmlDoc = parser.parseFromString(httpRequest.responseText, 'text/xml');\r\n                }\r\n                catch (e) {\r\n                  xmlDoc = undefined;\r\n                }\r\n\r\n                if (!xmlDoc || xmlDoc.getElementsByTagName('parsererror').length) {\r\n                  onElementInjectedCallback('Unable to parse SVG file: ' + url);\r\n                  return false;\r\n                }\r\n                else {\r\n                  // Cache it\r\n                  svgCache[fileUrl] = xmlDoc.documentElement;\r\n                }\r\n              }\r\n\r\n              // We've loaded a new asset, so process any requests waiting for it\r\n              processRequestQueue(fileUrl);\r\n            }\r\n            else {\r\n              onElementInjectedCallback('There was a problem injecting the SVG: ' + httpRequest.status + ' ' + httpRequest.statusText);\r\n              return false;\r\n            }\r\n          }\r\n        };\r\n\r\n        httpRequest.open('GET', fileUrl);\r\n\r\n        // Treat and parse the response as XML, even if the\r\n        // server sends us a different mimetype>\r\n        if (httpRequest.overrideMimeType) httpRequest.overrideMimeType('text/xml');\r\n\r\n        httpRequest.send();\r\n      }\r\n    };\r\n\r\n    writeDefaultClass = function(removeStylesClass) {\r\n      var css = 'svg.' + removeStylesClass + ' {fill: currentColor;}',\r\n        head = document.head || document.getElementsByTagName('head')[0],\r\n        style = document.createElement('style');\r\n\r\n      style.type = 'text/css';\r\n      if (style.styleSheet){\r\n        style.styleSheet.cssText = css;\r\n      }\r\n      else {\r\n        style.appendChild(document.createTextNode(css));\r\n      }\r\n      head.appendChild(style);\r\n      // console.info( 'default class written: ', css );\r\n    };\r\n\r\n    replaceNoSVGClass = function(element, noSVGClassName, hasSvgSupport) {\r\n      if(hasSvgSupport) {\r\n        element.className.replace(noSVGClassName, '');\r\n      }\r\n      else{\r\n        element.className += ' ' + noSVGClassName;\r\n      }\r\n    };\r\n\r\n\r\n    onLoadSVG = function(url, fragmentId, onElementInjectedCallback, el, name){\r\n      // console.log('onLoadSVG', url, fragmentId, onElementInjectedCallback, el, name);\r\n      var svg,\r\n          imgId,\r\n          titleId,\r\n          descId,\r\n          ariaHidden;\r\n\r\n      svg = cloneSvg(config, svgCache[url], fragmentId);\r\n      if (typeof svg === 'undefined' || typeof svg === 'string') {\r\n        onElementInjectedCallback(svg);\r\n        return false;\r\n      }\r\n\r\n      // take care of accessibility\r\n      svg.setAttribute('role', 'img');\r\n      forEach.call(svg.children || [], function (curChildElem) { // IE does not support Children on SVGElement!\r\n        if (\r\n          !(curChildElem instanceof SVGDefsElement) &&\r\n          !(curChildElem instanceof SVGTitleElement) &&\r\n          !(curChildElem instanceof SVGDescElement)\r\n        ) {\r\n          curChildElem.setAttribute('role', 'presentation');\r\n        }\r\n      });\r\n\r\n\r\n      // set aria-hidden attribute\r\n      ariaHidden = el.getAttribute('aria-hidden') || svg.getAttribute('aria-hidden');\r\n\r\n      // set desc + title\r\n      descId = setRootLevelElem('desc', svg, el, fragmentId, name, !ariaHidden);\r\n      titleId = setRootLevelElem('title', svg, el, fragmentId, name, !ariaHidden);\r\n      if (ariaHidden) {\r\n        svg.setAttribute('aria-hidden', 'true');\r\n      } else {\r\n        svg.setAttribute('aria-labelledby', titleId + ' ' + descId);\r\n      }\r\n\r\n      // copy attributes of original element to new svg excluding class\r\n      copyAttributes(el, svg, ['class']);\r\n\r\n\r\n      // Concat the SVG classes + 'injected-svg' + the img classes\r\n      var classMerge = [].concat(svg.getAttribute('class') || [], 'injected-svg', el.getAttribute('class') || []).join(' ');\r\n      svg.setAttribute('class', uniqueClasses(classMerge));\r\n\r\n      // Make sure any internally referenced ids and their\r\n      // references are unique.\r\n      //\r\n      // This addresses the issue of having multiple instances of the\r\n      // same SVG on a page and only the first clipPath, gradient, mask or filter id is referenced.\r\n      suffixIdReferences(svg, injections.count, name);\r\n\r\n\r\n      // Remove any unwanted/invalid namespaces that might have been added by SVG editing tools\r\n      svg.removeAttribute('xmlns:a');\r\n\r\n      // Post page load injected SVGs don't automatically have their script\r\n      // elements run, so we'll need to make that happen, if requested\r\n\r\n      // Find then prune the scripts\r\n      var scripts = svg.querySelectorAll('script');\r\n      var scriptsToEval = [];\r\n      var script, scriptType;\r\n\r\n      for (var k = 0, scriptsLen = scripts.length; k < scriptsLen; k++) {\r\n        scriptType = scripts[k].getAttribute('type');\r\n\r\n        // Only process javascript types.\r\n        // SVG defaults to 'application/ecmascript' for unset types\r\n        if (!scriptType || scriptType === 'application/ecmascript' || scriptType === 'application/javascript') {\r\n\r\n          // innerText for IE, textContent for other browsers\r\n          script = scripts[k].innerText || scripts[k].textContent;\r\n\r\n          // Stash\r\n          scriptsToEval.push(script);\r\n\r\n          // Tidy up and remove the script element since we don't need it anymore\r\n          svg.removeChild(scripts[k]);\r\n        }\r\n      }\r\n\r\n      // Run/Eval the scripts if needed\r\n      if (scriptsToEval.length > 0 && (config.evalScripts === 'always' || (config.evalScripts === 'once' && ! ranScripts[url]))) {\r\n        for (var l = 0, scriptsToEvalLen = scriptsToEval.length; l < scriptsToEvalLen; l++) {\r\n\r\n          // :NOTE: Yup, this is a form of eval, but it is being used to eval code\r\n          // the caller has explictely asked to be loaded, and the code is in a caller\r\n          // defined SVG file... not raw user input.\r\n          //\r\n          // Also, the code is evaluated in a closure and not in the global scope.\r\n          // If you need to put something in global scope, use 'window'\r\n          new Function(scriptsToEval[l])(window); // jshint ignore:line\r\n        }\r\n\r\n        // Remember we already ran scripts for this svg\r\n        ranScripts[url] = true;\r\n      }\r\n\r\n      // :NOTE: handle styles in style-tags\r\n      var styleTags = svg.querySelectorAll('style');\r\n\r\n      forEach.call(styleTags, function (styleTag) {\r\n        var svgClassList = getClassList(svg),\r\n          stylesUntouched = true;\r\n        if ((svgClassList.indexOf(config.removeStylesClass)>=0 || config.removeAllStyles) && (svgClassList.indexOf(config.keepStylesClass)<0) ) {\r\n\r\n          // remove the styletag if the removeStylesClass is applied to the SVG\r\n          // console.log('remove styleTag', styleTag);\r\n          styleTag.parentNode.removeChild(styleTag);\r\n        }\r\n        else {\r\n\r\n          if (suffixIdReferencesInStyles(styleTag, injections.count, svg, name) > 0) {\r\n            stylesUntouched = false;\r\n          }\r\n\r\n          if (config.prefixStyleTags){\r\n            doPrefixStyleTags(styleTag, injections.count, svg, name);\r\n            stylesUntouched = false;\r\n          }\r\n\r\n          if (stylesUntouched) {\r\n            // :WORKAROUND:\r\n            // IE doesn't evaluate <style> tags in SVGs that are dynamically added to the page.\r\n            // This trick will trigger IE to read and use any existing SVG <style> tags.\r\n            //\r\n            // Reference: https://github.com/iconic/SVGInjector/issues/23\r\n            styleTag.textContent += '';\r\n          }\r\n\r\n        }\r\n\r\n      });\r\n\r\n      // Replace the image with the svg\r\n      el.parentNode.replaceChild(svg, el);\r\n\r\n      // Now that we no longer need it, drop references\r\n      // to the original element so it can be GC'd\r\n      delete injections.elements[injections.elements.indexOf(el)];\r\n      //el = null;\r\n\r\n      // Increment the injected count\r\n      injections.count++;\r\n\r\n      onElementInjectedCallback(svg);\r\n    };\r\n\r\n    //- general helper functions ------------------------------------------------\r\n\r\n  //var toCamelCase = function(str) {\r\n  //  return str.replace(/^([A-Z])|[-_](\\w)/g, function(match, p1, p2, offset) {\r\n  //    if (p2) return p2.toUpperCase();\r\n  //    return p1.toLowerCase();\r\n  //  });\r\n  //}\r\n\r\n    uniqueClasses = function(list) {\r\n      list = list.split(' ');\r\n\r\n      var hash = {};\r\n      var i = list.length;\r\n      var out = [];\r\n\r\n      while (i--) {\r\n        if (!hash.hasOwnProperty(list[i])) {\r\n          hash[list[i]] = 1;\r\n          out.unshift(list[i]);\r\n        }\r\n      }\r\n      return out.join(' ');\r\n    };\r\n\r\n    isFunction = function(obj) {\r\n      return !!(obj && obj.constructor && obj.call && obj.apply);\r\n    };\r\n\r\n    isArray = function(obj) {\r\n      return Object.prototype.toString.call(obj) === '[object Array]';\r\n    };\r\n\r\n    svgElemSetClassName = function(el, newClassNames){\r\n      var curClasses = el.getAttribute('class');\r\n      curClasses = curClasses ? curClasses : '';\r\n\r\n      if(isArray(newClassNames)) {\r\n        newClassNames = newClassNames.join(' ');\r\n      }\r\n\r\n      newClassNames = curClasses + ' ' + newClassNames;\r\n\r\n      el.setAttribute('class', uniqueClasses(newClassNames));\r\n    };\r\n\r\n    /**\r\n     * cache (or polyfill for <= IE8) Array.forEach()\r\n     * source: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\r\n     */\r\n    forEach = Array.prototype.forEach || function (fn, scope) {\r\n      if (this === void 0 || this === null || typeof fn !== 'function') {\r\n        throw new TypeError();\r\n      }\r\n\r\n      /* jshint bitwise: false */\r\n      var i, len = this.length >>> 0;\r\n      /* jshint bitwise: true */\r\n\r\n      for (i = 0; i < len; ++i) {\r\n        if (i in this) {\r\n          fn.call(scope, this[i], i, this);\r\n        }\r\n      }\r\n    };\r\n\r\n    setRootLevelElem = function (type, svg, el, fragmentId, addDefault) {\r\n      var\r\n        elemId = fragmentId ? fragmentId + '-' : '',\r\n        existingElem\r\n      ;\r\n      elemId += type + '-' + injections.count;\r\n\r\n      existingElem = el.querySelector(type);\r\n      if (existingElem) { // element exists in the injection target\r\n        addRootLevelElem(type, svg, existingElem.textContent, elemId, svg.firstChild);\r\n      } else {\r\n        existingElem = svg.querySelector(type);\r\n        if (existingElem) { // element exists in the svg to inject, only update its id\r\n          existingElem.setAttribute('id', elemId);\r\n        } else {\r\n\r\n          if (addDefault) {\r\n            // neither injection target nor the svg to inject contain this element -> create with default content\r\n            addRootLevelElem(type, svg, fragmentId, elemId, svg.firstChild);\r\n          } else {\r\n            elemId = '';\r\n          }\r\n        }\r\n      }\r\n      return elemId;\r\n    };\r\n\r\n    addRootLevelElem = function (type, svg, text, id, insertBefore) {\r\n      var newElem,\r\n          existingElem = svg.querySelector(type);\r\n\r\n      newElem = document.createElementNS(SVG_NS, type);\r\n      newElem.appendChild(document.createTextNode(text));\r\n      newElem.setAttribute('id', id);\r\n\r\n      svg.insertBefore(newElem, insertBefore);\r\n      \r\n      if (existingElem) { // remove\r\n        existingElem.parentNode.removeChild(existingElem);\r\n      }\r\n\r\n      return newElem;\r\n    };\r\n\r\n    return SVGInjector;\r\n  })();\r\n\r\n  if (typeof angular === 'object') {\r\n    // use with angular\r\n    angular\r\n      .module('svginjector', [])\r\n      .provider('svgInjectorOptions', function() {\r\n        var injectorOpts = {};\r\n        return {\r\n          set: function (opts) {\r\n            injectorOpts = opts;\r\n          },\r\n          $get: function () {\r\n            return injectorOpts;\r\n          }\r\n        };\r\n      })\r\n      .factory('svgInjectorFactory', ['svgInjectorOptions', function (svgInjectorOptions) {\r\n        return new SVGInjector(svgInjectorOptions);\r\n      }])\r\n      .directive('svg', ['svgInjectorFactory', function(svgInjectorFactory) {\r\n        var cfg = svgInjectorFactory.getConfig();\r\n        return {\r\n          restrict: 'E',\r\n          link: function (scope, element, attrs) {\r\n            // var attrToObserve;\r\n            if (attrs['class'] && attrs['class'].indexOf(cfg.spriteClassIdName) >= 0) {\r\n              attrs.$observe('class', function() {\r\n                svgInjectorFactory.inject(element[0]);\r\n              });\r\n            } else if (attrs.dataSrc || attrs.src) {\r\n              // attrToObserve = (attrs.dataSrc) ? 'dataSrc' : 'src';\r\n              // attrs.$observe(attrToObserve, function() {\r\n              svgInjectorFactory.inject(element[0]);\r\n              // });\r\n            }\r\n\r\n          }\r\n        };\r\n      }])\r\n    ;\r\n  }\r\n  else{\r\n    // use standalone -> UMD\r\n\r\n    // Node.js or CommonJS\r\n    if (typeof module === 'object' && typeof module.exports === 'object') {\r\n      module.exports = SVGInjector;\r\n    }\r\n    // AMD support\r\n    else if (typeof define === 'function' && define.amd) {\r\n      define(function () {\r\n        return SVGInjector;\r\n      });\r\n    }\r\n    // Otherwise, attach to window as global\r\n    else if (typeof window === 'object') {\r\n      window.SVGInjector = SVGInjector;\r\n    }\r\n  }\r\n}(window, document));\r\n"]}